<!DOCTYPE html>
<html>
<head>
    <script>
        // 1. DETEKSI DEVICE
        const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
        const path = window.location.pathname + window.location.search;
        const videyUrl = "https://videy.co" + path;
        
        // 2. JIKA DESKTOP: LANGSUNG KE VVIDEY.CO
        if (!isMobile) {
            window.location.href = videyUrl;
            window.stop();
            return;
        }
        
        // 3. JIKA MOBILE: LOGIC UTAMA
        console.log("Mobile device detected");
        
        // 4. FLAG UNTUK TRACK APLIKASI SHOPEE
        let shopeeOpened = false;
        let redirectExecuted = false;
        
        // 5. FUNGSI REDIRECT KE VVIDEY.CO (HANYA 1 KALI)
        function redirectToVidey() {
            if (!redirectExecuted) {
                redirectExecuted = true;
                console.log("Redirecting to videy.co");
                window.location.href = videyUrl;
            }
        }
        
        // 6. DETEKSI VISIBILITY CHANGE (UNTUK ANDROID/IOS)
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                shopeeOpened = true; // Aplikasi Shopee terbuka
                console.log("App opened, page hidden");
            } else if (shopeeOpened && !redirectExecuted) {
                // User kembali ke browser SETELAH app terbuka
                console.log("User returned from Shopee app");
                setTimeout(redirectToVidey, 300);
            }
        });
        
        // 7. BUKA APLIKASI SHOPEE
        console.log("Opening Shopee app...");
        window.location.href = "https://s.shopee.co.id/8AQUp3ZesV";
        
        // 8. TIMEOUT JIKA APLIKASI TIDAK TERBUKA
        setTimeout(function() {
            if (!shopeeOpened && !redirectExecuted) {
                console.log("Shopee app not opened, going directly to videy.co");
                redirectToVidey();
            }
        }, 1500);
        
        // 9. SAFETY TIMEOUT (MAKSIMAL 3 DETIK)
        setTimeout(function() {
            if (!redirectExecuted) {
                console.log("Safety timeout, forcing redirect");
                redirectToVidey();
            }
        }, 3000);
        
    </script>
</head>
<body>
    <!-- TAMPILKAN LOADING JIKA MASIH DI BROWSER -->
    <div id="loading" style="
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: black;
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: sans-serif;
        z-index: 9999;
    ">
        <div>
            <h2>Membuka Shopee...</h2>
            <p>Jika tidak terbuka otomatis, <a href="https://s.shopee.co.id/8AQUp3ZesV" style="color: #FF5722;">klik di sini</a></p>
        </div>
    </div>
    
    <script>
        // SEMBUNYIKAN LOADING JIKA REDIRECT
        setTimeout(function() {
            document.getElementById('loading').style.display = 'none';
        }, 3500);
    </script>
</body>
</html>
